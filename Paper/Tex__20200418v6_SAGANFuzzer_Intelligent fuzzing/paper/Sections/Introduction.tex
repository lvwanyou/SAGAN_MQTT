\section{Introduction}

With the arrival of Industry 4.0 and Internet+, some new trends in the development of manufacturing. Strategic plans have been put forward to build the next generation of manufacturing. These strategies intend to empower the industry through information technology, such as optimizing the processes, reducing the costs and increasing the efficiency, to unlock greater productivity. The ICS, as the basic component of the automated production of the national economy and the people's livelihood, is a key part of the national safe strategy. The interaction between the ICS and its network environment becomes more frequent. The system is facing increasing external security threats. When applying the ICP into actual production, it is necessary to discover potential protocol vulnerabilities in time and prevent them in advance. 

Currently, applying traditional fuzz testing techniques to detect loopholes in ICPs is an effective method. However, there are some limitations to applying the techniques: (i) High demand for the testers. The tester is required to design appropriate test cases according to the communication protocol specification running in the system. (ii) Long test cycle. The entire testing process will last a long time. It is impossible to complete the test task efficiently when it is in urgent need. (iii) No versatility. Traditional methods design specific test cases based on specific test objectives, which is not universal.

Compared with traditional fuzzing works, deep learning methods for fuzzing bypass the process of building protocol specifications and protocol automata, reducing the workload and breaking the border of different protocols to achieve the generality. However, poor machine learning algorithms not only consume a lot of computing resources during the training of the model but also tend to generate a large number of error-formatted protocol message sequences after the training, resulting in normal crashes and error messages, which are quickly rejected by the server and prevent further testing.

In the process of fuzzing, there are a lot of crashes and error messages. But there is a challenge in distinguishing what of them are vulnerabilities and how to find real vulnerabilities from these crashes. In order to explore the balance between normal and abnormal exceptions, we propose a fuzzy test case generation methodology based on the ideal of deep adversarial learning in this paper. The contributions are summarized as follows:

\begin{itemize}
\item[(1)] We propose a methodology based on GAN to deal with fuzzy data generation, in which it can intelligently learn to generate testing data by itself. We apply Wasserstein distance\cite{arjovsky2017wasserstein}  to solve GAN's limitations for sequences of discrete, and introduce a penalty term to ensure the diversity of generated test case.
\item[(2)] On the premise of ensuring the lightweight of the model and saving computing resources, we introduce the self-attention mechanism which dispenses with recurrence and convolutions entirely and allows significantly more parallelization which requires significantly less time to train, makes it superior in quality of generating fake but plausible testing data in the process of model design.
\item[(3)] On top of the approach, we build a universal fuzzing framework based on improved SAGAN, called SAGANFuzzer, which can not only deal with the fuzzing of most ICPs but also show the superiority over other existing deep learning methods in theory and application. %\textcolor[rgb]{1,0,0}{Judge this part exist or not: Moreover, in the process of sampling, this paper introduces a series of anti-random strategies to improve the probability of anomalies throwing}
\item[(4)] Since there are no corresponding evaluation standards in fuzzing based on deep adversarial learning, we propose a series of metrics to evaluate the performance of our framework from the evaluation of the performance of the machine learning model and the evaluation of the vulnerability detection capability
\end{itemize}

To evaluate its performance, we apply it to test several ICPs. The experimental results show that our method has better performance than and can obtain excellent test results in different ICPs. In terms of test effectiveness and efficiency, the expected results are achieved.

The remainder of this paper is organized as follows. Section \uppercase\expandafter{\romannumeral2} discusses the related work. Section \uppercase\expandafter{\romannumeral3} details the optimized improved SAGAN algorithm and the entire methodology design. Section \uppercase\expandafter{\romannumeral4} presents the experiment and evaluation results. Section \uppercase\expandafter{\romannumeral5} concludes the paper and discusses some ideas about future work.
